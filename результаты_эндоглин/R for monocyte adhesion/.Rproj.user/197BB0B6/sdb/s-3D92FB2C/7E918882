{
    "collab_server" : "",
    "contents" : "library(doBy)\nlibrary(ggplot2)\nlibrary(multcomp)\nlibrary(nlme)\nlibrary(boot)\nlibrary(cowplot)\n\ngetwd()\npath <-\"D:/Анастасия Столбовая/результаты_эндоглин/R for monocyte adhesion/\"\n\nread_my_csv <- function(f, sep){\n        data <- read.csv(file=f, sep=sep, dec=\",\", stringsAsFactors = F)\n        data$file <- f\n        data\n}\nfiles_cells_3 <- list.files(\"D:/Анастасия Столбовая/результаты_эндоглин/R for monocyte adhesion/2018-10-04_co-culture_THP-1_TGF\", pattern = \"*.csv\", full.names = F)\npath <- \"D:/Анастасия Столбовая/результаты_эндоглин/R for monocyte adhesion/2018-10-04_co-culture_THP-1_TGF\"\nsetwd(path)\nf3 <- lapply(files_cells_3, read_my_csv, sep=\";\")\nclass(f3)\nlapply(f3, class)\ncount_THP1_TGF_exp1 <- do.call(plyr::rbind.fill, f3)\nclass(count_THP1_TGF_exp1)\nwrite.table(count_THP1_TGF_exp1, file=\"count_THP1_TGF_exp1.csv\", sep=\";\", row.names = F)\n\npath <-\"D:/Анастасия Столбовая/результаты_эндоглин/R for monocyte adhesion/\"\nsetwd(path)\ncount_THP1_TGF <- read.csv(\"count_THP1_TGF_exp1.csv\", sep=\";\", dec=\",\", stringsAsFactors = F)\n\ncount_THP1_TGF <- count_THP1_TGF[, -c(2:10,12)]\ncount_THP1_TGF$mab <- \"1\"\ncount_THP1_TGF$mab<- stringr::str_split_fixed(count_THP1_TGF$file, pattern=\"\\\\_\", n=2)[,2]\ncount_THP1_TGF$mab<- stringr::str_split_fixed(count_THP1_TGF$mab, pattern=\"\\\\.\", n=2)[,1]\ncount_THP1_TGF[109:126,4] <- \"TGFb\"\n\ncount_THP1_TGF$well <- stringr::str_split_fixed(count_THP1_TGF$name, pattern=\"\\\\_\", n=2)[,1]\ncount_THP1_TGF$n <- stringr::str_split_fixed(count_THP1_TGF$name, pattern=\"\\\\_\", n=2)[,2]\n\nlength(count_THP1_TGF$n)\nlength(count_THP1_TGF$well)\n\ncount_THP1_TGF_sum <- summaryBy(left.circles ~ mab+well, data=count_THP1_TGF, FUN=mean, keep.names = T)\n\n\nggplot(data=count_THP1_TGF_sum, aes(x=mab, y=left.circles))+geom_point()\n\ncount_THP1_TGF_sum$mab <- factor(count_THP1_TGF_sum$mab) \ncount_THP1_TGF_sum$mab <- relevel(count_THP1_TGF_sum$mab, ref=\"TGFb\") \n\nmod_1 <- glm(left.circles ~ mab, data=count_THP1_TGF_sum, family=\"poisson\")\nmod <- glm.nb(left.circles ~ mab, data=count_THP1_TGF_sum)\nsummary(mod)\n\ntest <- (glht(model=mod, linfct= mcp(mab = \"Tukey\")))\nsummary(test)\n\ntest_Dunnet <- (glht(model=mod, linfct= mcp(mab = \"Dunnet\")))\nsummary(test_Dunnet)\n\n\nmydata_ <- data.frame(mab = levels(count_THP1_TGF_sum$mab))\n\nmydata_$predict <- predict(mod, newdata = mydata_, re.form = NA, type = \"response\", se.fit=T)$fit\n\nmydata_$se <- predict(mod, newdata = mydata_, re.form = NA, type = \"response\", se.fit=T)$se\n\n\nmydata_$mab <- factor(mydata_$mab, levels=c( \"control\", \"TGFb\", \"3A7+TGFb\" ,  \"2C8+TGFb\" ,   \"4C9+TGFb\" , \"4E4+TGFb\" , \"5H7+TGFb\"))\nlevels(mydata_$mab) <- c( \"К\", \"TGFb\", \"Ig1+TGFb\" , \"2C8+TGFb\" ,   \"4C9+TGFb\" , \"4E4+TGFb\" , \"5H7+TGFb\")\n\n\nfig3 <- ggplot(mydata_, aes(mab, predict)) +\n        geom_bar(stat = \"identity\", width = 0.45, color = \"black\", fill = \"grey\") +\n        geom_errorbar(width = 0.25, aes(ymin = predict-1.96*se, ymax =predict+1.96*se)) +\n        geom_segment(aes(x=c(\"TGFb\"), xend=c(\"4E4+TGFb\"), y=164, yend=164)) +\n        geom_segment(aes(x=c(\"Ig1+TGFb\"), xend=c(\"2C8+TGFb\"), y=155, yend=155)) +\n        geom_segment(aes(x=c(\"Ig1+TGFb\"), xend=c(\"4C9+TGFb\"), y=158, yend=158)) +\n        geom_text(aes(x = \"Ig1+TGFb\", y = 165, label = \"*\"), size = 7) +\n        geom_text(aes(x = \"2C8+TGFb\", y = 159, label = \"*\"), size = 7) +\n        geom_segment(aes(x=c(\"К\"), xend=c(\"TGFb\"), y=169, yend=169)) +\n        geom_segment(aes(x=c(\"К\"), xend=c(\"Ig1+TGFb\"), y=171, yend=171)) +\n        geom_segment(aes(x=c(\"К\"), xend=c(\"2C8+TGFb\"), y=173, yend=173))+\n        geom_segment(aes(x=c(\"К\"), xend=c(\"4C9+TGFb\"), y=175, yend=175)) +\n        geom_segment(aes(x=c(\"К\"), xend=c(\"4E4+TGFb\"), y=177, yend=177))+\n        geom_segment(aes(x=c(\"К\"), xend=c(\"5H7+TGFb\"), y=179, yend=179))+\n        geom_text(aes(x = \"TGFb\", y = 181, label = \"***\"), size = 7) +\n        theme_bw()+\n        # scale_y_continuous(breaks = c(\"0\", \"20\", \"40\", \"60\", \"80\",\"100\", \"120\", \"140\", \"160\",\"180\", \"200\"))+\n        xlab(\"\")+\n        ylab(\"Число клеток THP-1\")+\n        theme(axis.text.x = element_text(angle=30, hjust=1))\n       \n       \n\nggsave(\"fig3_count_THP1_TGF.jpeg\", fig3, width=10, height=12, dpi=600, units=\"cm\")\n",
    "created" : 1539077515831.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2284647431",
    "id" : "7E918882",
    "lastKnownWriteTime" : 1539082042,
    "last_content_update" : -2147483648,
    "path" : "D:/Анастасия Столбовая/результаты_эндоглин/R for monocyte adhesion/count_THP1_TGF.R",
    "project_path" : "count_THP1_TGF.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}